
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>invstm</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>invstm</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     INVSTM ( Inverse of state transformation matrix )

     SUBROUTINE INVSTM ( MAT, INVMAT )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Return the inverse of a state transformation matrix.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/rotation.html">ROTATION</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     MATH
     MATRIX
     TRANSFORMATION
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     DOUBLE PRECISION      MAT    ( 6, 6 )
     DOUBLE PRECISION      INVMAT ( 6, 6 )
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     MAT        I   A state transformation matrix.
     INVMAT     O   The inverse of MAT.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     MAT      is a state transformation matrix for converting states
              relative to one frame to states relative to another.
              The state transformation of a state vector, S, is
              performed by the matrix-vector product.

                 MAT * S.

              For MAT to be a &quot;true&quot; state transformation matrix
              it must have the form

                  .-            -.
                  |       :      |
                  |   R   :   0  |
                  |.......:......|
                  |       :      |
                  |  W*R  :   R  |
                  |       :      |
                  `-            -'

              where R is a 3x3 rotation matrix, 0 is the 3x3 zero
              matrix and W is a 3x3 skew-symmetric matrix.

              NOTE: no checks are performed on MAT to ensure that it
                    does indeed have the form described above.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     INVMAT   is the inverse of MAT under the operation of matrix
              multiplication.

              If MAT has the form described above, then INVMAT has
              the form shown below.

                 .-             -.
                 |     t  :      |
                 |    R   :   0  |
                 |........:......|
                 |      t :    t |
                 | (W*R)  :   R  |
                 |        :      |
                 `-             -'

              (The superscript &quot;t&quot; denotes the matrix transpose
              operation.)
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.

     1)  No checks are performed to ensure that the input matrix is
         indeed a state transformation matrix.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Given a matrix for transforming states relative frame 1 to
     states relative frame 2, the routine produces the inverse
     matrix. That is, it returns the matrix for transforming states
     relative to frame 2 to states relative to frame 1.

     This special routine exists because unlike the inverse of a
     rotation matrix, the inverse of a state transformation matrix,
     is NOT simply the transpose of the matrix.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Suppose you have a geometric state of a spacecraft in Earth
        body-fixed reference frame and wish to express this state
        relative to an Earth centered J2000 frame. The following
        example code illustrates how to carry out this computation.

        Use the PCK kernel below to load the required high precision
        orientation of the ITRF93 Earth body-fixed reference frame.
        Note that the body ID code used in this file for the Earth is
        3000.

           earth_720101_070426.bpc


        Example code begins here.


              PROGRAM INVSTM_EX1
              IMPLICIT NONE

        C
        C     Local variables.
        C
              DOUBLE PRECISION      ET
              DOUBLE PRECISION      INVMAT ( 6, 6 )
              DOUBLE PRECISION      ISTAT1 ( 6    )
              DOUBLE PRECISION      ISTAT2 ( 6    )
              DOUBLE PRECISION      MAT    ( 6, 6 )
              DOUBLE PRECISION      STATE  ( 6    )
              DOUBLE PRECISION      XMAT   ( 6, 6 )

              INTEGER               EARTH

        C
        C     Define the state of the spacecraft, in km and
        C     km/s, and the ET epoch, in seconds past J2000.
        C
              DATA                  ET    /  0.0D0 /
              DATA                  STATE /  175625246.29100420D0,
             .                               164189388.12540060D0,
             .                               -62935198.26067264D0,
             .                                   11946.73372264D0,
             .                                  -12771.29732556D0,
             .                                      13.84902914D0 /

        C
        C     Load the required high precision Earth PCK.
        C
              CALL <a href="furnsh.html">FURNSH</a> ( 'earth_720101_070426.bpc' )

        C
        C     First get the state transformation from J2000 frame
        C     to Earth body-fixed frame at the time of interest ET.
        C     The body ID code used in high precision PCK files for
        C     the Earth is 3000; this number indicates that the
        C     terrestrial frame used is ITRF93.
        C
              EARTH = 3000
              CALL <a href="tisbod.html">TISBOD</a> ( 'J2000', EARTH, ET, MAT )

        C
        C     Get the inverse of MAT.
        C
              CALL <b>INVSTM</b> ( MAT,  INVMAT          )

        C
        C     Transform from bodyfixed state to inertial state.
        C
              CALL <a href="mxvg.html">MXVG</a> ( INVMAT, STATE, 6, 6, ISTAT1 )

        C
        C     Print the resulting state.
        C
              WRITE(*,'(A)') 'Input state in Earth centered J2000 '
             .            // 'frame, using <b>INVSTM</b>:'
              WRITE(*,'(A,3F16.3)') '   Position:', ISTAT1(1:3)
              WRITE(*,'(A,3F16.3)') '   Velocity:', ISTAT1(4:6)

        C
        C     Compute the same state using <a href="sxform.html">SXFORM</a>.
        C
              CALL <a href="sxform.html">SXFORM</a> ( 'ITRF93', 'J2000', ET, XMAT )
              CALL <a href="mxvg.html">MXVG</a>   ( XMAT, STATE, 6, 6, ISTAT2 )

              WRITE(*,*)
              WRITE(*,'(A)') 'Input state in Earth centered J2000 '
             .            // 'frame, using <a href="sxform.html">SXFORM</a>:'
              WRITE(*,'(A,3F16.3)') '   Position:', ISTAT2(1:3)
              WRITE(*,'(A,3F16.3)') '   Velocity:', ISTAT2(4:6)

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


        Input state in Earth centered J2000 frame, using <b>INVSTM</b>:
           Position:   192681395.921  -143792821.383   -62934296.473
           Velocity:          30.312          32.007          13.876

        Input state in Earth centered J2000 frame, using <a href="sxform.html">SXFORM</a>:
           Position:   192681395.921  -143792821.383   -62934296.473
           Velocity:          30.312          32.007          13.876
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman       (JPL)
     J. Diaz del Rio    (ODC Space)
     W.L. Taber         (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 25-NOV-2021 (JDR)

        Added IMPLICIT NONE statement.

        Removed unnecessary Standard SPICE error handling calls to
        register/unregister this routine in the error handling
        subsystem; this routine is Error free.

        Edited the header to comply with NAIF standard.
        Added complete code example based on the existing fragment.

    SPICELIB Version 1.0.2, 22-APR-2010 (NJB)

        Header correction: assertions that the output
        can overwrite the input have been removed.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 29-OCT-1990 (WLT)</PRE>
<h4>Link to routine INVSTM source file <a href='../../../src/spicelib/invstm.f'>invstm.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:36:28 2021</pre>

</body>
</html>

