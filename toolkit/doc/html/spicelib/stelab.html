
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>stelab</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>stelab</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     STELAB     ( Stellar Aberration )

     SUBROUTINE STELAB ( POBJ, VOBS, APPOBJ )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Correct the apparent position of an object for stellar
     aberration.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EPHEMERIS
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     DOUBLE PRECISION   POBJ   ( 3 )
     DOUBLE PRECISION   VOBS   ( 3 )
     DOUBLE PRECISION   APPOBJ ( 3 )
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     POBJ       I   Position of an object with respect to the
                    observer.
     VOBS       I   Velocity of the observer with respect to the
                    Solar System barycenter.
     APPOBJ     O   Apparent position of the object with respect to
                    the observer, corrected for stellar aberration.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     POBJ     is the position (x, y, z, km) of an object with
              respect to the observer, possibly corrected for
              light time.

     VOBS     is the velocity (dx/dt, dy/dt, dz/dt, km/sec)
              of the observer with respect to the Solar System
              barycenter.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     APPOBJ   is the apparent position of the object relative
              to the observer, corrected for stellar aberration.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If the velocity of the observer is greater than or equal
         to the speed of light, the error SPICE(VALUEOUTOFRANGE)
         is signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     Let r be the vector from the observer to the object, and v be
         -                                                    -
     the velocity of the observer with respect to the Solar System
     barycenter. Let w be the angle between them. The aberration
     angle phi is given by

          sin(phi) = v sin(w) / c

     Let h be the vector given by the cross product
         -

           h = r X v
           -   -   -

     Rotate r by phi radians about h to obtain the apparent position
            -                      -
     of the object.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Compute the apparent position of the Moon relative to the
        Earth, corrected for one light-time and stellar aberration,
        given the geometric state of the Earth relative to the Solar
        System Barycenter, and the difference between the stellar
        aberration corrected and uncorrected position vectors, taking
        several steps.

        First, compute the light-time corrected state of the Moon body
        as seen by the Earth, using its geometric state. Then apply
        the correction for stellar aberration to the light-time
        corrected state of the target body.

        The code in this example could be replaced by a single call
        to <a href="spkpos.html">SPKPOS</a>:

            CALL <a href="spkpos.html">SPKPOS</a> ( 'MOON', ET, 'J2000', 'LT+S', 'EARTH',
           .               POS,   LT                           )


        Use the meta-kernel shown below to load the required SPICE
        kernels.


           KPL/MK

           File name: stelab_ex1.tm

           This meta-kernel is intended to support operation of SPICE
           example programs. The kernels shown here should not be
           assumed to contain adequate or correct versions of data
           required by SPICE-based user applications.

           In order for an application to use this meta-kernel, the
           kernels referenced here must be present in the user's
           current working directory.

           The names and contents of the kernels referenced
           by this meta-kernel are as follows:

              File name                     Contents
              ---------                     --------
              de418.bsp                     Planetary ephemeris
              naif0009.tls                  Leapseconds

           \begindata

              KERNELS_TO_LOAD = ( 'de418.bsp',
                                  'naif0009.tls'  )

           \begintext

           End of meta-kernel


        Example code begins here.


              PROGRAM STELAB_EX1
              IMPLICIT NONE

        C
        C     Local variables.
        C
              CHARACTER*(6)         REFFRM
              CHARACTER*(12)        UTCSTR

              DOUBLE PRECISION      APPDIF ( 3 )
              DOUBLE PRECISION      ET
              DOUBLE PRECISION      LT
              DOUBLE PRECISION      PCORR  ( 3 )
              DOUBLE PRECISION      POS    ( 3 )
              DOUBLE PRECISION      SOBS   ( 6 )

              INTEGER               IDOBS
              INTEGER               IDTARG

        C
        C     Assign an observer, Earth, target, Moon, time of interest
        C     and reference frame for returned vectors.
        C
              IDOBS  = 399
              IDTARG = 301
              UTCSTR = 'July 4 2004'
              REFFRM = 'J2000'

        C
        C     Load the needed kernels.
        C
              CALL <a href="furnsh.html">FURNSH</a> ( 'stelab_ex1.tm' )

        C
        C     Convert the time string to ephemeris time, J2000.
        C
              CALL <a href="str2et.html">STR2ET</a> ( UTCSTR, ET )

        C
        C     Get the state of the observer with respect to the solar
        C     system barycenter.
        C
              CALL <a href="spkssb.html">SPKSSB</a> ( IDOBS, ET, REFFRM, SOBS )

        C
        C     Get the light-time corrected position POS of the target
        C     body IDTARG as seen by the observer.
        C
              CALL <a href="spkapo.html">SPKAPO</a> ( IDTARG, ET, REFFRM, SOBS, 'LT', POS, LT )

        C
        C     Output the uncorrected vector.
        C
              WRITE(*,*) 'Uncorrected position vector'
              WRITE(*,'(A,3F19.6)') '   ', POS(1), POS(2), POS(3)

        C
        C     Apply the correction for stellar aberration to the
        C     light-time corrected position of the target body.
        C
              CALL <b>STELAB</b> ( POS, SOBS(4), PCORR )

        C
        C     Output the corrected position vector and the apparent
        C     difference from the uncorrected vector.
        C
              WRITE(*,*) ' '
              WRITE(*,*) 'Corrected position vector'
              WRITE(*,'(A,3F19.6)') '   ', PCORR(1), PCORR(2),
             .                             PCORR(3)

        C
        C     Apparent difference.
        C
              CALL <a href="vsub.html">VSUB</a> ( POS, PCORR, APPDIF )
              WRITE(*,*) ' '
              WRITE(*,*) 'Apparent difference'
              WRITE(*,'(A,3F19.6)') '   ', APPDIF(1), APPDIF(2),
             .                            APPDIF(3)

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


         Uncorrected position vector
                 201738.725087     -260893.141602     -147722.589056

         Corrected position vector
                 201765.929516     -260876.818077     -147714.262441

         Apparent difference
                    -27.204429         -16.323525          -8.326615
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     [1]  W. Owen, &quot;The Treatment of Aberration in Optical Navigation&quot;,
          JPL IOM #314.8-524, 8 February 1985.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman       (JPL)
     J. Diaz del Rio    (ODC Space)
     H.A. Neilan        (JPL)
     W.L. Taber         (JPL)
     I.M. Underwood     (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.2.0, 05-JUL-2021 (JDR)

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Added example's
        meta-kernel and problem statement. Created complete code
        example from existing code fragments.

    SPICELIB Version 1.1.1, 08-JAN-2008 (NJB)

        The header example was updated to remove references
        to <a href="spkapp.html">SPKAPP</a>.

    SPICELIB Version 1.1.0, 08-FEB-1999 (WLT)

        The example was corrected so that SOBS(4) is passed
        into <b>STELAB</b> instead of STARG(4).

    SPICELIB Version 1.0.2, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.1, 08-AUG-1990 (HAN)

        $Examples section of the header was updated to replace
        calls to the GEF ephemeris readers by calls to the
        new SPK ephemeris reader.

    SPICELIB Version 1.0.0, 31-JAN-1990 (IMU) (WLT) (HAN)</PRE>
<h4>Link to routine STELAB source file <a href='../../../src/spicelib/stelab.f'>stelab.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:36:57 2021</pre>

</body>
</html>

