
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>vsepg</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>vsepg</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     VSEPG ( Angular separation of vectors, general dimension )

     DOUBLE PRECISION FUNCTION VSEPG ( V1, V2, NDIM )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Find the separation angle in radians between two double precision
     vectors of arbitrary dimension. This angle is defined as zero if
     either vector is zero.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     ANGLE
     VECTOR
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     DOUBLE PRECISION   V1 ( * )
     DOUBLE PRECISION   V2 ( * )
     INTEGER            NDIM
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     V1         I   First vector.
     V2         I   Second vector.
     NDIM       I   The number of elements in V1 and V2.

     The function returns the angle between V1 and V2 expressed in
     radians.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     V1,
     V2       are two double precision vectors of arbitrary dimension.
              Either V1 or V2, or both, may be the zero vector.

              An implicit assumption exists that V1 and V2 are
              specified in the same reference space. If this is not
              the case, the numerical result of this routine has no
              meaning.

     NDIM     is the dimension of both V1 and V2.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     The function returns the angle between V1 and V2 expressed in
     radians.

     <b>VSEPG</b> is strictly non-negative. For input vectors of four or more
     dimensions, the angle is defined as the generalization of the
     definition for three dimensions. If either V1 or V2 is the zero
     vector, then <b>VSEPG</b> is defined to be 0 radians.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     In four or more dimensions this angle does not have a physically
     realizable interpretation. However, the angle is defined as
     the generalization of the following definition which is valid in
     three or two dimensions:

        In the plane, it is a simple matter to calculate the angle
        between two vectors once the two vectors have been made to be
        unit length. Then, since the two vectors form the two equal
        sides of an isosceles triangle, the length of the third side
        is given by the expression

           LENGTH = 2.0 * SIN ( <b>VSEPG</b>/2.0 )

        The length is given by the magnitude of the difference of the
        two unit vectors

           LENGTH = NORM ( U1 - U2 )

        Once the length is found, the value of <b>VSEPG</b> may be calculated
        by inverting the first expression given above as

           <b>VSEPG</b> = 2.0 * ARCSIN ( LENGTH/2.0 )

        This expression becomes increasingly unstable when <b>VSEPG</b> gets
        larger than <a href="pi.html">PI</a>/2 radians or 90 degrees. In this situation
        (which is easily detected by determining the sign of the dot
        product of V1 and V2) the supplementary angle is calculated
        first and then <b>VSEPG</b> is given by

           <b>VSEPG</b> = <a href="pi.html">PI</a> - SUPPLEMENTARY_ANGLE
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Define two sets of n-dimensional vectors and compute the
        angular separation between each vector in first set and the
        corresponding vector in the second set.


        Example code begins here.


              PROGRAM VSEPG_EX1
              IMPLICIT NONE

        C
        C     SPICELIB functions.
        C
              DOUBLE PRECISION      <b>VSEPG</b>

        C
        C     Local parameters.
        C
              INTEGER               NDIM
              PARAMETER           ( NDIM   = 4 )

              INTEGER               SETSIZ
              PARAMETER           ( SETSIZ = 3 )

        C
        C     Local variables.
        C
              DOUBLE PRECISION      V1   ( NDIM, SETSIZ )
              DOUBLE PRECISION      V2   ( NDIM, SETSIZ )

              INTEGER               I
              INTEGER               J

        C
        C     Define the two vector sets.
        C
              DATA                  V1 /
             .                      1.D0,  0.D0,  0.D0,  0.D0,
             .                      1.D0,  0.D0,  0.D0,  0.D0,
             .                      3.D0,  0.D0,  0.D0,  0.D0   /

              DATA                  V2 /
             .                      1.D0,  0.D0,  0.D0,  0.D0,
             .                      0.D0,  1.D0,  0.D0,  0.D0,
             .                     -5.D0,  0.D0,  0.D0,  0.D0  /

        C
        C     Calculate the angular separation between each pair
        C     of vectors.
        C
              DO I=1, SETSIZ

                 WRITE(*,'(A,4F6.1)')  'First vector            : ',
             .                        ( V1(J,I), J=1,NDIM )
                 WRITE(*,'(A,4F6.1)')  'Second vector           : ',
             .                        ( V2(J,I), J=1,NDIM )
                 WRITE(*,'(A,F15.10)') 'Angular separation (rad): ',
             .                <b>VSEPG</b> ( V1(1,I), V2(1,I), NDIM )
                 WRITE(*,*)

              END DO

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


        First vector            :    1.0   0.0   0.0   0.0
        Second vector           :    1.0   0.0   0.0   0.0
        Angular separation (rad):    0.0000000000

        First vector            :    1.0   0.0   0.0   0.0
        Second vector           :    0.0   1.0   0.0   0.0
        Angular separation (rad):    1.5707963268

        First vector            :    3.0   0.0   0.0   0.0
        Second vector           :   -5.0   0.0   0.0   0.0
        Angular separation (rad):    3.1415926536
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     1)  The user is required to insure that the input vectors will not
         cause floating point overflow upon calculation of the vector
         dot product since no error detection or correction code is
         implemented. In practice, this is not a significant
         restriction.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     C.A. Curzon        (JPL)
     J. Diaz del Rio    (ODC Space)
     K.R. Gehringer     (JPL)
     H.A. Neilan        (JPL)
     W.L. Taber         (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.2.0, 06-JUL-2021 (JDR)

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Removed
        unnecessary $Revisions section.

        Added complete code example based on existing example.

    SPICELIB Version 1.1.0, 29-FEB-1996 (KRG)

        The declaration for the SPICELIB function <a href="pi.html">PI</a> is now
        preceded by an EXTERNAL statement declaring <a href="pi.html">PI</a> to be an
        external function. This removes a conflict with any
        compilers that have a <a href="pi.html">PI</a> intrinsic function.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 31-JAN-1990 (CAC) (HAN)</PRE>
<h4>Link to routine VSEPG source file <a href='../../../src/spicelib/vsepg.f'>vsepg.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:37:06 2021</pre>

</body>
</html>

