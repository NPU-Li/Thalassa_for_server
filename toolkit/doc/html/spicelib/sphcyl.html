
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>sphcyl</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>sphcyl</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     SPHCYL ( Spherical to cylindrical coordinates )

     SUBROUTINE SPHCYL ( RADIUS, COLAT, SLON, R, CLON, Z )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Convert from spherical coordinates to cylindrical coordinates.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     CONVERSION
     COORDINATES
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     DOUBLE PRECISION   RADIUS
     DOUBLE PRECISION   COLAT
     DOUBLE PRECISION   SLON
     DOUBLE PRECISION   R
     DOUBLE PRECISION   CLON
     DOUBLE PRECISION   Z
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  -------------------------------------------------
     RADIUS     I   Distance of point from origin.
     COLAT      I   Polar angle (co-latitude in radians) of point.
     SLON       I   Azimuthal angle (longitude) of point (radians).
     R          O   Distance of point from Z axis.
     CLON       O   Angle (radians) of point from XZ plane.
     Z          O   Height of point above XY plane.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     RADIUS   is the distance of the point from origin.

     COLAT    is the polar angle (co-latitude in radians) of the
              point.

     SLON     is the azimuthal angle (longitude) of the point
              (radians).
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     R        is the distance of the point of interest from Z-axis.

     CLON     is the cylindrical angle (radians) of the point from
              the XZ plane. CLON is set equal to SLON.

     Z        is the height of the point above XY plane.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This returns the cylindrical coordinates of a point whose
     position is input through spherical coordinates.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Compute the spherical coordinates of the position of the Moon
        as seen from the Earth, and convert them to cylindrical and
        rectangular coordinates.

        Use the meta-kernel shown below to load the required SPICE
        kernels.


           KPL/MK

           File name: sphcyl_ex1.tm

           This meta-kernel is intended to support operation of SPICE
           example programs. The kernels shown here should not be
           assumed to contain adequate or correct versions of data
           required by SPICE-based user applications.

           In order for an application to use this meta-kernel, the
           kernels referenced here must be present in the user's
           current working directory.

           The names and contents of the kernels referenced
           by this meta-kernel are as follows:

              File name                     Contents
              ---------                     --------
              de421.bsp                     Planetary ephemeris
              naif0012.tls                  Leapseconds


           \begindata

              KERNELS_TO_LOAD = ( 'de421.bsp',
                                  'naif0012.tls'  )

           \begintext

           End of meta-kernel


        Example code begins here.


              PROGRAM SPHCYL_EX1
              IMPLICIT NONE

        C
        C     SPICELIB functions
        C
              DOUBLE PRECISION      <a href="dpr.html">DPR</a>

        C
        C     Local parameters
        C
              CHARACTER*(*)         FMT1
              PARAMETER           ( FMT1 = '(A,F20.8)' )

        C
        C     Local variables
        C
              DOUBLE PRECISION      CLON
              DOUBLE PRECISION      COLAT
              DOUBLE PRECISION      ET
              DOUBLE PRECISION      LT
              DOUBLE PRECISION      POS    ( 3 )
              DOUBLE PRECISION      R
              DOUBLE PRECISION      RADIUS
              DOUBLE PRECISION      RECTAN ( 3 )
              DOUBLE PRECISION      SLON
              DOUBLE PRECISION      Z

        C
        C     Load SPK and LSK kernels, use a meta kernel for
        C     convenience.
        C
              CALL <a href="furnsh.html">FURNSH</a> ( 'sphcyl_ex1.tm' )

        C
        C     Look up the geometric state of the Moon as seen from
        C     the Earth at 2017 Mar 20, relative to the J2000
        C     reference frame.
        C
              CALL <a href="str2et.html">STR2ET</a> ( '2017 Mar 20', ET )

              CALL <a href="spkpos.html">SPKPOS</a> ( 'Moon',  ET,  'J2000', 'NONE',
             .              'Earth', POS, LT               )

        C
        C     Convert the position vector POS to spherical
        C     coordinates.
        C
              CALL <a href="recsph.html">RECSPH</a> ( POS, RADIUS, COLAT, SLON )

        C
        C     Convert the spherical coordinates to cylindrical.
        C
              CALL <b>SPHCYL</b> ( RADIUS, COLAT, SLON, R, CLON, Z )

        C
        C     Convert the cylindrical coordinates to rectangular.
        C
              CALL <a href="cylrec.html">CYLREC</a> ( R, CLON, Z, RECTAN )


              WRITE(*,*) ' '
              WRITE(*,*) 'Original rectangular coordinates:'
              WRITE(*,*) ' '
              WRITE(*,FMT1) '  X           (km): ', POS(1)
              WRITE(*,FMT1) '  Y           (km): ', POS(2)
              WRITE(*,FMT1) '  Z           (km): ', POS(3)
              WRITE(*,*) ' '
              WRITE(*,*) 'Spherical coordinates:'
              WRITE(*,*) ' '
              WRITE(*,FMT1) '  Radius      (km): ', RADIUS
              WRITE(*,FMT1) '  Colatitude (deg): ', COLAT*<a href="dpr.html">DPR</a>()
              WRITE(*,FMT1) '  Longitude  (deg): ', SLON*<a href="dpr.html">DPR</a>()
              WRITE(*,*) ' '
              WRITE(*,*) 'Cylindrical coordinates:'
              WRITE(*,*) ' '
              WRITE(*,FMT1) '  Radius      (km): ', R
              WRITE(*,FMT1) '  Longitude  (deg): ', CLON*<a href="dpr.html">DPR</a>()
              WRITE(*,FMT1) '  Z           (km): ', Z
              WRITE(*,*) ' '
              WRITE(*,*) 'Rectangular coordinates from <a href="cylrec.html">CYLREC</a>:'
              WRITE(*,*) ' '
              WRITE(*,FMT1) '  X           (km): ', RECTAN(1)
              WRITE(*,FMT1) '  Y           (km): ', RECTAN(2)
              WRITE(*,FMT1) '  Z           (km): ', RECTAN(3)
              WRITE(*,*) ' '

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


         Original rectangular coordinates:

          X           (km):      -55658.44323296
          Y           (km):     -379226.32931475
          Z           (km):     -126505.93063865

         Spherical coordinates:

          Radius      (km):      403626.33912495
          Colatitude (deg):         108.26566077
          Longitude  (deg):         -98.34959789

         Cylindrical coordinates:

          Radius      (km):      383289.01777726
          Longitude  (deg):         -98.34959789
          Z           (km):     -126505.93063865

         Rectangular coordinates from <a href="cylrec.html">CYLREC</a>:

          X           (km):      -55658.44323296
          Y           (km):     -379226.32931475
          Z           (km):     -126505.93063865


     2) Create a table showing a variety of spherical coordinates
        and the corresponding cylindrical coordinates.

        Corresponding spherical and cylindrical coordinates are
        listed to three decimal places. Input and output angles are
        in degrees.


        Example code begins here.


              PROGRAM SPHCYL_EX2
              IMPLICIT NONE

        C
        C     SPICELIB functions
        C
              DOUBLE PRECISION      <a href="dpr.html">DPR</a>
              DOUBLE PRECISION      <a href="rpd.html">RPD</a>

        C
        C     Local parameters.
        C
              INTEGER               NREC
              PARAMETER           ( NREC = 11 )

        C
        C     Local variables.
        C
              DOUBLE PRECISION      CLON
              DOUBLE PRECISION      COLAT  ( NREC )
              DOUBLE PRECISION      R
              DOUBLE PRECISION      RADIUS ( NREC )
              DOUBLE PRECISION      RCOLAT
              DOUBLE PRECISION      RSLON
              DOUBLE PRECISION      SLON   ( NREC )
              DOUBLE PRECISION      Z

              INTEGER               I

        C
        C     Define the input spherical coordinates. Input angles
        C     in degrees.
        C
              DATA                 RADIUS / 0.D0, 1.D0,     1.D0,
             .                              1.D0, 1.4142D0, 1.D0,
             .                              1.D0, 1.D0,     1.4142D0,
             .                              1.D0, 0.D0               /

              DATA                 COLAT /  0.D0,   90.D0,  90.D0,
             .                              0.D0,   45.D0,  90.D0,
             .                            180.D0,   90.D0, 135.D0,
             .                              0.D0,   90.D0            /

              DATA                 SLON  /  0.D0,    0.D0,  90.D0,
             .                              0.D0,  180.D0, -90.D0,
             .                              0.D0,   45.D0, 180.D0,
             .                             180.D0,  33.D0            /

        C
        C     Print the banner.
        C
              WRITE(*,*) '  RADIUS   COLAT     SLON  '
             . //        '    R       CLON      Z    '
              WRITE(*,*) ' -------  -------  ------- '
             . //        ' -------  -------  ------- '

        C
        C     Do the conversion. Output angles in degrees.
        C
              DO I = 1, NREC

                 RCOLAT = COLAT(I) * <a href="rpd.html">RPD</a>()
                 RSLON  = SLON(I)  * <a href="rpd.html">RPD</a>()

                 CALL <b>SPHCYL</b>( RADIUS(I), RCOLAT, RSLON, R, CLON, Z )

                 WRITE (*,'(6F9.3)') RADIUS(I), COLAT(I), SLON(I),
             .                       R, CLON * <a href="dpr.html">DPR</a>(), Z

              END DO

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


           RADIUS   COLAT     SLON      R       CLON      Z
          -------  -------  -------  -------  -------  -------
            0.000    0.000    0.000    0.000    0.000    0.000
            1.000   90.000    0.000    1.000    0.000    0.000
            1.000   90.000   90.000    1.000   90.000    0.000
            1.000    0.000    0.000    0.000    0.000    1.000
            1.414   45.000  180.000    1.000  180.000    1.000
            1.000   90.000  -90.000    1.000  -90.000    0.000
            1.000  180.000    0.000    0.000    0.000   -1.000
            1.000   90.000   45.000    1.000   45.000    0.000
            1.414  135.000  180.000    1.000  180.000   -1.000
            1.000    0.000  180.000    0.000  180.000    1.000
            0.000   90.000   33.000    0.000   33.000    0.000


     3) Other than the obvious conversion between coordinate systems
        this routine could be used to obtain the axial projection
        from a sphere to a cylinder about the z-axis that contains
        the equator of the sphere.

        Such a projection is valuable because it preserves the
        areas between regions on the sphere and their projections to
        the cylinder.


        Example code begins here.


              PROGRAM SPHCYL_EX3
              IMPLICIT NONE

        C
        C     SPICELIB functions
        C
              DOUBLE PRECISION      <a href="dpr.html">DPR</a>
              DOUBLE PRECISION      <a href="rpd.html">RPD</a>

        C
        C     Local parameters
        C
              CHARACTER*(*)         FMT1
              PARAMETER           ( FMT1 = '(A,F23.11)' )

        C
        C     Local variables
        C
              DOUBLE PRECISION      CLON
              DOUBLE PRECISION      COLAT
              DOUBLE PRECISION      RADIUS
              DOUBLE PRECISION      R
              DOUBLE PRECISION      SLON
              DOUBLE PRECISION      Z

        C
        C     Define the point whose projection is to be
        C     computed.
        C
              RADIUS =   100.D0
              SLON   =    45.D0  * <a href="rpd.html">RPD</a>()
              COLAT  =   102.5D0 * <a href="rpd.html">RPD</a>()

        C
        C     Convert the spherical coordinates to cylindrical.
        C
              CALL <b>SPHCYL</b> ( RADIUS, COLAT, SLON, R, CLON, Z )

              WRITE(*,*) 'Coordinates of the projected point on '
             .        // 'cylinder:'
              WRITE(*,*) ' '
              WRITE(*,FMT1) '  Radius     (km): ', R
              WRITE(*,FMT1) '  Longitude (deg): ', CLON*<a href="dpr.html">DPR</a>()
              WRITE(*,FMT1) '  Z          (km): ', Z

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


         Coordinates of the projected point on cylinder:

          Radius     (km):          97.62960071199
          Longitude (deg):          45.00000000000
          Z          (km):         -21.64396139381
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     J. Diaz del Rio    (ODC Space)
     B.V. Semenov       (JPL)
     W.L. Taber         (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 05-JUL-2021 (JDR)

        Changed the argument names LONGS and LONG to SLON and CLON for
        consistency with other routines.

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Removed
        unnecessary $Revisions section. Added complete code examples.

    SPICELIB Version 1.0.2, 26-JUL-2016 (BVS)

        Minor headers edits.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 31-JAN-1990 (WLT)</PRE>
<h4>Link to routine SPHCYL source file <a href='../../../src/spicelib/sphcyl.f'>sphcyl.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:36:50 2021</pre>

</body>
</html>

