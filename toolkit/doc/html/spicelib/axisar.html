
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>axisar</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>axisar</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     AXISAR ( Axis and angle to rotation )

     SUBROUTINE AXISAR ( AXIS, ANGLE, R )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Construct a rotation matrix that rotates vectors by a specified
     angle about a specified axis.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/rotation.html">ROTATION</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     MATRIX
     ROTATION
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     DOUBLE PRECISION      AXIS  ( 3 )
     DOUBLE PRECISION      ANGLE
     DOUBLE PRECISION      R     ( 3, 3 )
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     AXIS       I   Rotation axis.
     ANGLE      I   Rotation angle, in radians.
     R          O   Rotation matrix corresponding to AXIS and ANGLE.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     AXIS,
     ANGLE    are, respectively, a rotation axis and a rotation
              angle. AXIS and ANGLE determine a coordinate
              transformation whose effect on any vector V is to
              rotate V by ANGLE radians about the vector AXIS.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     R        is a rotation matrix representing the coordinate
              transformation determined by AXIS and ANGLE: for
              each vector V, R*V is the vector resulting from
              rotating V by ANGLE radians about AXIS.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     Error free.

     1)  If AXIS is the zero vector, the rotation generated is the
         identity. This is consistent with the specification of <a href="vrotv.html">VROTV</a>.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     <b>AXISAR</b> can be thought of as a partial inverse of <a href="raxisa.html">RAXISA</a>.  <b>AXISAR</b>
     really is a `left inverse': the code fragment

        CALL <a href="raxisa.html">RAXISA</a> ( R,    AXIS,  ANGLE )
        CALL <b>AXISAR</b> ( AXIS, ANGLE, R     )

     preserves R, except for round-off error, as long as R is a
     rotation matrix.

     On the other hand, the code fragment

        CALL <b>AXISAR</b> ( AXIS, ANGLE, R     )
        CALL <a href="raxisa.html">RAXISA</a> ( R,    AXIS,  ANGLE )

     preserves AXIS and ANGLE, except for round-off error, only if
     ANGLE is in the range (0, pi). So <b>AXISAR</b> is a right inverse
     of <a href="raxisa.html">RAXISA</a> only over a limited domain.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Compute a matrix that rotates vectors by pi/2 radians about
        the Z-axis, and compute the rotation axis and angle based on
        that matrix.


        Example code begins here.


              PROGRAM AXISAR_EX1
              IMPLICIT NONE

        C
        C     SPICELIB functions.
        C
              DOUBLE PRECISION      <a href="dpr.html">DPR</a>
              DOUBLE PRECISION      <a href="halfpi.html">HALFPI</a>

        C
        C     Local variables
        C
              DOUBLE PRECISION      ANGLE
              DOUBLE PRECISION      ANGOUT
              DOUBLE PRECISION      AXIS   ( 3    )
              DOUBLE PRECISION      AXOUT  ( 3    )
              DOUBLE PRECISION      <a href="rotmat.html">ROTMAT</a> ( 3, 3 )

              INTEGER               I
              INTEGER               J

        C
        C     Define an axis and an angle for rotation.
        C
              AXIS(1) = 0.D0
              AXIS(2) = 0.D0
              AXIS(3) = 1.D0
              ANGLE   = <a href="halfpi.html">HALFPI</a>()

        C
        C     Determine the rotation matrix.
        C
              CALL <b>AXISAR</b> ( AXIS, ANGLE, <a href="rotmat.html">ROTMAT</a> )

        C
        C     Now calculate the rotation axis and angle based on
        C     <a href="rotmat.html">ROTMAT</a> as input.
        C
              CALL <a href="raxisa.html">RAXISA</a> ( <a href="rotmat.html">ROTMAT</a>, AXOUT, ANGOUT )

        C
        C     Display the results.
        C
              WRITE(*,'(A)') 'Rotation matrix:'
              WRITE(*,*)
              DO I = 1, 3
                 WRITE(*,'(3F10.5)') ( <a href="rotmat.html">ROTMAT</a>(I,J), J=1,3 )
              END DO
              WRITE(*,*)
              WRITE(*,'(A,3F10.5)') 'Rotation axis       :', AXOUT
              WRITE(*,'(A,F10.5)')  'Rotation angle (deg):',
             .                                      ANGOUT * <a href="dpr.html">DPR</a>()

              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


        Rotation matrix:

           0.00000  -1.00000   0.00000
           1.00000   0.00000   0.00000
           0.00000   0.00000   1.00000

        Rotation axis       :   0.00000   0.00000   1.00000
        Rotation angle (deg):  90.00000


     2) Linear interpolation between two rotation matrices.

        Let R(t) be a time-varying rotation matrix; R could be
        a C-matrix describing the orientation of a spacecraft
        structure. Given two points in time t1 and t2 at which
        R(t) is known, and given a third time t3, where

           t1  &lt;  t3  &lt;  t2,

        we can estimate R(t3) by linear interpolation. In other
        words, we approximate the motion of R by pretending that
        R rotates about a fixed axis at a uniform angular rate
        during the time interval [t1, t2]. More specifically, we
        assume that each column vector of R rotates in this
        fashion. This procedure will not work if R rotates through
        an angle of pi radians or more during the time interval
        [t1, t2]; an aliasing effect would occur in that case.


        Example code begins here.


              PROGRAM AXISAR_EX2
              IMPLICIT NONE

        C
        C     SPICELIB functions.
        C
              DOUBLE PRECISION      <a href="dpr.html">DPR</a>
              DOUBLE PRECISION      <a href="halfpi.html">HALFPI</a>

        C
        C     Local variables
        C
              DOUBLE PRECISION      ANGLE
              DOUBLE PRECISION      AXIS   ( 3    )
              DOUBLE PRECISION      DELTA  ( 3, 3 )
              DOUBLE PRECISION      FRAC
              DOUBLE PRECISION      Q      ( 3, 3 )
              DOUBLE PRECISION      R1     ( 3, 3 )
              DOUBLE PRECISION      R2     ( 3, 3 )
              DOUBLE PRECISION      R3     ( 3, 3 )
              DOUBLE PRECISION      T1
              DOUBLE PRECISION      T2
              DOUBLE PRECISION      T3

              INTEGER               I
              INTEGER               J

        C
        C     Lets assume that R(t) is the matrix that rotates
        C     vectors by pi/2 radians about the Z-axis every
        C     minute.
        C
        C     Let
        C
        C        R1 = R(t1), for t1 =  0&quot;, and
        C        R2 = R(t2), for t1 = 60&quot;.
        C
        C     Define both matrices and times.
        C
              AXIS(1) = 0.D0
              AXIS(2) = 0.D0
              AXIS(3) = 1.D0

              T1 =  0.D0
              T2 = 60.D0
              T3 = 30.D0

              CALL <a href="ident.html">IDENT</a>  ( R1 )
              CALL <b>AXISAR</b> ( AXIS, <a href="halfpi.html">HALFPI</a>(), R2 )

        C
        C     Lets compute
        C
        C                    -1
        C        Q  = R2 * R1  ,
        C
        C     The rotation axis and angle of Q define the rotation
        C     that each column of R(t) undergoes from time `t1' to
        C     time `t2'.  Since R(t) is orthogonal, we can find Q
        C     using the transpose of R1.  We find the rotation axis
        C     and angle via <a href="raxisa.html">RAXISA</a>.

              CALL <a href="mxmt.html">MXMT</a>   ( R2,   R1,    Q      )
              CALL <a href="raxisa.html">RAXISA</a> ( Q,    AXIS,  ANGLE  )

        C
        C     Find the fraction of the total rotation angle that R
        C     rotates through in the time interval [t1, t3].
        C
              FRAC = ( T3 - T1 )  /  ( T2 - T1 )

        C
        C     Finally, find the rotation DELTA that R(t) undergoes
        C     during the time interval [t1, t3], and apply that
        C     rotation to R1, yielding R(t3), which we'll call R3.
        C
              CALL <b>AXISAR</b> ( AXIS,   FRAC * ANGLE,  DELTA  )
              CALL <a href="mxm.html">MXM</a>    ( DELTA,  R1,            R3     )

        C
        C     Display the results.
        C
              WRITE(*,'(A,F10.5)')  'Time (s)            :', T3
              WRITE(*,'(A,3F10.5)') 'Rotation axis       :', AXIS
              WRITE(*,'(A,F10.5)')  'Rotation angle (deg):',
             .                               FRAC * ANGLE * <a href="dpr.html">DPR</a>()
              WRITE(*,'(A)')        'Rotation matrix     :'
              WRITE(*,*)
              DO I = 1, 3
                 WRITE(*,'(3F10.5)') ( R3(I,J), J=1,3 )
              END DO


              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


        Time (s)            :  30.00000
        Rotation axis       :   0.00000   0.00000   1.00000
        Rotation angle (deg):  45.00000
        Rotation matrix     :

           0.70711  -0.70711   0.00000
           0.70711   0.70711   0.00000
           0.00000   0.00000   1.00000
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman       (JPL)
     J. Diaz del Rio    (ODC Space)
     W.L. Taber         (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.2.0, 06-JUL-2021 (JDR)

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Removed
        unnecessary $Revisions section.

        Added complete code examples based on existing code fragments.

    SPICELIB Version 1.1.0, 25-AUG-2005 (NJB)

        Updated to remove non-standard use of duplicate arguments
        in <a href="vrotv.html">VROTV</a> call.

        Identity matrix is now obtained from <a href="ident.html">IDENT</a>.

    SPICELIB Version 1.0.1, 10-MAR-1992 (WLT)

        Comment section for permuted index source lines was added
        following the header.

    SPICELIB Version 1.0.0, 30-AUG-1990 (NJB)</PRE>
<h4>Link to routine AXISAR source file <a href='../../../src/spicelib/axisar.f'>axisar.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:35:58 2021</pre>

</body>
</html>

