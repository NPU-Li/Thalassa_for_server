
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>spkw17</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>spkw17</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     SPKW17 ( SPK, write a type 17 segment )

     SUBROUTINE SPKW17 ( HANDLE, BODY,  CENTER, FRAME, FIRST, LAST,
    .                    SEGID,  EPOCH, EQEL,   RAPOL, DECPOL  )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Write an SPK segment of type 17 given a type 17 data record.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/spk.html">SPK</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EPHEMERIS
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     INTEGER               HANDLE
     INTEGER               BODY
     INTEGER               CENTER
     CHARACTER*(*)         FRAME
     DOUBLE PRECISION      FIRST
     DOUBLE PRECISION      LAST
     CHARACTER*(*)         SEGID
     DOUBLE PRECISION      EPOCH
     DOUBLE PRECISION      EQEL  ( 9 )
     DOUBLE PRECISION      RAPOL
     DOUBLE PRECISION      DECPOL
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     HANDLE     I   Handle of an SPK file open for writing.
     BODY       I   Body code for ephemeris object.
     CENTER     I   Body code for the center of motion of the body.
     FRAME      I   The reference frame of the states.
     FIRST      I   First valid time for which states can be computed.
     LAST       I   Last valid time for which states can be computed.
     SEGID      I   Segment identifier.
     EPOCH      I   Epoch of elements in seconds past J2000.
     EQEL       I   Array of equinoctial elements.
     RAPOL      I   Right Ascension of the reference plane's pole.
     DECPOL     I   Declination of the reference plane's pole.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     HANDLE   is the file handle of an SPK file that has been
              opened for writing.

     BODY     is the NAIF ID for the body whose states are
              to be recorded in the SPK file.

     CENTER   is the NAIF ID for the center of motion associated
              with BODY.

     FRAME    is the reference frame that states are referenced to,
              for example 'J2000'.

     FIRST,
     LAST     are the bounds on the ephemeris times, expressed as
              seconds past J2000.

     SEGID    is the segment identifier. An SPK segment identifier
              may contain up to 40 characters.

     EPOCH    is the epoch of equinoctial elements in seconds
              past the J2000 epoch.

     EQEL     is an array of 9 double precision numbers that
              are the equinoctial elements for some orbit relative
              to the equatorial frame of a central body.

                 Note: The Z-axis of the equatorial frame is the
                 direction of the pole of the central body relative
                 to FRAME. The X-axis is given by the cross product of
                 the Z-axis of FRAME with the direction of the pole of
                 the central body. The Y-axis completes a right handed
                 frame.

              The specific arrangement of the elements is spelled
              out below. The following terms are used in the
              discussion of elements of EQEL:

                 INC  --- inclination of the orbit
                 ARGP --- argument of periapse
                 NODE --- longitude of the ascending node
                 E    --- eccentricity of the orbit
                 M0   --- mean anomaly

              EQEL(1)   is the semi-major axis (A) of the orbit in km.

              EQEL(2)   is the value of H at the specified epoch:

                           H =  E * SIN( ARGP + NODE )

              EQEL(3)   is the value of K at the specified epoch:

                           K =  E * COS( ARGP + NODE )

              EQEL(4)   is the mean longitude at the epoch of the
                        elements measured in radians:

                           ( M0 + ARGP + NODE )

              EQEL(5)   is the value of P at the specified epoch:

                           P =  TAN( INC/2 ) * SIN( NODE )

              EQEL(6)   is the value of Q at the specified epoch:

                           Q =  TAN( INC/2 ) * COS( NODE )

              EQEL(7)   is the rate of the longitude of periapse
                        at the epoch of the elements.

                           ( dARGP/dt + dNODE/dt )

                        This rate is assumed to hold for all time. The
                        rate is measured in radians per second.

              EQEL(8)   is the derivative of the mean longitude:

                           ( dM0/dt + dARGP/dt + dNODE/dt )

                        This rate is assumed to be constant and is
                        measured in radians/second.

              EQEL(9)   is the rate of the longitude of the ascending
                        node:

                           ( dNODE/dt )

                        This rate is measured in radians per second.

     RAPOL    is the Right Ascension of the pole of the reference
              plane relative to FRAME measured in radians.

     DECPOL   is the declination of the pole of the reference plane
              relative to FRAME measured in radians.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     None.

     The routine writes an SPK type 17 segment to the file attached to
     HANDLE.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If the semi-major axis is less than or equal to zero, the
         error SPICE(BADSEMIAXIS) is signaled.

     2)  If the eccentricity of the orbit corresponding to the values
         of H and K ( EQEL(2) and EQEL(3) ) is greater than 0.9, the
         error SPICE(ECCOUTOFRANGE) is signaled.

     3)  If the segment identifier has more than 40 non-blank
         characters, the error SPICE(SEGIDTOOLONG) is signaled.

     4)  If the segment identifier contains non-printing characters,
         the error SPICE(NONPRINTABLECHARS) is signaled.

     5)  If there are inconsistencies in the BODY, CENTER, FRAME or
         FIRST and LAST times, an error is signaled by a routine in
         the call tree of this routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     A new type 17 SPK segment is written to the SPK file attached
     to HANDLE.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine writes an SPK type 17 data segment to the open SPK
     file according to the format described in the type 17 section of
     the SPK Required Reading. The SPK file must have been opened with
     write access.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Suppose that at a given time you have the classical elements
        of Daphnis relative to the equatorial frame of Saturn. These
        can be converted to equinoctial elements and stored in an SPK
        file as a type 17 segment so that Daphnis can be used within
        the SPK subsystem of the SPICE system.

        The example code shown below creates an SPK type 17 kernel
        with a single segment using such data.


        Example code begins here.


              PROGRAM SPKW17_EX1
              IMPLICIT NONE

        C
        C     Local parameters.
        C
              INTEGER               NAMLEN
              PARAMETER           ( NAMLEN = 40 )

              CHARACTER*(*)         SPK17
              PARAMETER           ( SPK17  = 'spkw17_ex1.bsp' )

        C
        C     The SPK type 17 segment will contain data for Daphnis
        C     (ID 635) with respect to Saturn (ID 699) in the J2000
        C     reference frame.
        C
              INTEGER               BODY
              PARAMETER           ( BODY   = 635     )

              INTEGER               CENTER
              PARAMETER           ( CENTER = 699     )

              CHARACTER*(*)         <a href="frmnam.html">FRMNAM</a>
              PARAMETER           ( <a href="frmnam.html">FRMNAM</a> = 'J2000' )

        C
        C     This is the list of parameters used to represent the
        C     classical elements:
        C
        C        Variable     Meaning
        C        --------     ---------------------------------------
        C        A            Semi-major axis in km.
        C        ECC          Eccentricity of orbit.
        C        INC          Inclination of orbit.
        C        NODE         Longitude of the ascending node at
        C                     epoch.
        C        OMEGA        Argument of periapse at epoch.
        C        M            Mean anomaly at epoch.
        C        DMDT         Mean anomaly rate in radians/second.
        C        DNODE        Rate of change of longitude of
        C                     ascending node in radians/second.
        C        DOMEGA       Rate of change of argument of periapse
        C                     in radians/second.
        C        EPOCH        The epoch of the elements in seconds
        C                     past the J2000 epoch.
        C
              DOUBLE PRECISION      A
              PARAMETER           ( A      =  1.36505608D+05  )

              DOUBLE PRECISION      ECC
              PARAMETER           ( ECC    = -2.105898062D-05 )

              DOUBLE PRECISION      INC
              PARAMETER           ( INC    = -3.489710429D-05 )

              DOUBLE PRECISION      NODE
              PARAMETER           ( NODE   = -3.349237456D-02 )

              DOUBLE PRECISION      OMEGA
              PARAMETER           ( OMEGA  =  1.52080206722D0 )

              DOUBLE PRECISION      M
              PARAMETER           ( M      =  1.21177109734D0 )

              DOUBLE PRECISION      DMDT
              PARAMETER           ( DMDT   =  1.218114014D-04 )

              DOUBLE PRECISION      DNODE
              PARAMETER           ( DNODE  = -5.96845468D-07  )

              DOUBLE PRECISION      DOMEGA
              PARAMETER           ( DOMEGA =  1.196601093D-06 )

              DOUBLE PRECISION      EPOCH
              PARAMETER           ( EPOCH  = 0.D0             )

        C
        C     In addition, the <b>SPKW17</b> routine requires the Right
        C     Ascension and Declination of the pole of the
        C     reference plane relative to the J2000 frame, in radians.
        C
              DOUBLE PRECISION      RAPOL
              PARAMETER           ( RAPOL  = 7.08332284D-01 )

              DOUBLE PRECISION      DECPOL
              PARAMETER           ( DECPOL = 1.45800286D0   )

        C
        C     Local variables.
        C
              CHARACTER*(NAMLEN)    IFNAME
              CHARACTER*(NAMLEN)    SEGID

              DOUBLE PRECISION      EQEL   ( 9 )
              DOUBLE PRECISION      FIRST
              DOUBLE PRECISION      LAST

              INTEGER               HANDLE
              INTEGER               NCOMCH

        C
        C     Set the start and end times of interval covered by
        C     segment.
        C
              FIRST  =  504878400.D0
              LAST   = 1578657600.D0

        C
        C     NCOMCH is the number of characters to reserve for the
        C     kernel's comment area. This example doesn't write
        C     comments, so set to zero.
        C
              NCOMCH = 0

        C
        C     Internal file name and segment ID.
        C
              IFNAME = 'Test for type 17 SPK internal file name'
              SEGID  = 'SPK type 17 test segment'

        C
        C     Open a new SPK file.
        C
              CALL <a href="spkopn.html">SPKOPN</a>( SPK17, IFNAME, NCOMCH, HANDLE )

        C
        C     Convert the classical elements to equinoctial elements
        C     (in the order compatible with type 17).
        C
              EQEL(1) = A
              EQEL(2) = ECC * SIN ( OMEGA + NODE )
              EQEL(3) = ECC * COS ( OMEGA + NODE )

              EQEL(4) = M + OMEGA + NODE

              EQEL(5) = TAN( INC/2.D0 ) * SIN( NODE )
              EQEL(6) = TAN( INC/2.D0 ) * COS( NODE )

              EQEL(7) =        DOMEGA + DNODE
              EQEL(8) = DMDT + DOMEGA + DNODE
              EQEL(9) = DNODE

        C
        C     Now add the segment.
        C
              CALL <b>SPKW17</b> ( HANDLE, BODY,  CENTER, <a href="frmnam.html">FRMNAM</a>,
             .              FIRST,  LAST,  SEGID,  EPOCH,
             .              EQEL,   RAPOL, DECPOL          )

        C
        C     Close the SPK file.
        C
              CALL <a href="spkcls.html">SPKCLS</a> ( HANDLE )

              END


        When this program is executed, no output is presented on
        screen. After run completion, a new SPK type 17 exists in
        the output directory.
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     J. Diaz del Rio    (ODC Space)
     W.L. Taber         (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 06-JUL-2021 (JDR)

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Added complete
        code example based on existing example.

    SPICELIB Version 1.0.1, 24-JUN-1999 (WLT)

        Corrected typographical errors in the header.

    SPICELIB Version 1.0.0, 08-JAN-1997 (WLT)</PRE>
<h4>Link to routine SPKW17 source file <a href='../../../src/spicelib/spkw17.f'>spkw17.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:36:56 2021</pre>

</body>
</html>

