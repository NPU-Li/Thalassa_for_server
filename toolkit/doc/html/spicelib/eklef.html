
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>eklef</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>eklef</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     EKLEF ( EK, load event file )

     ENTRY EKLEF ( FNAME, HANDLE )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Load an EK file, making it accessible to the EK readers.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/ek.html">EK</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     EK
     FILES
     SEARCH
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
    CHARACTER*(*)         FNAME
    INTEGER               HANDLE
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     FNAME      I   Name of EK file to load.
     HANDLE     O   File handle of loaded EK file.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     FNAME    is the name of a binary EK file to be loaded.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     HANDLE   is the handle of the EK file. The file is
              accessible by the EK reader routines once it
              has been loaded.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     1)  If the EK file indicated by FNAME contains a column whose
         name matches that of a column in an already loaded EK, but
         whose declared attributes don't match those of the loaded
         column of the same name, the error SPICE(BADATTRIBUTES) is
         signaled. HANDLE is is undefined in this case.

     2)  Loading an EK file that is already loaded does not cause side
         effects. The handle already associated with the file will be
         returned.

     3)  If a file open error occurs, the error is signaled by a
         routine in the call tree of this routine. HANDLE is undefined
         in this case.

     4)  If loading the input file would cause the maximum number of
         loaded EK files to be exceeded, the error
         SPICE(EKFILETABLEFULL) is signaled. HANDLE is undefined in
         this case. This routine will attempt to unload the file
         from the DAS system.

     5)  If loading the input file would cause the maximum number of
         loaded DAS files to be exceeded, an error is signaled by a
         routine in the call tree of this routine. HANDLE is undefined
         in this case. This routine will attempt to unload the file
         from the DAS system.

     6)  If loading the input file would cause the maximum number of
         segments allowed in loaded EK files to be exceeded, the error
         SPICE(EKSEGMENTTABLEFULL) is signaled. HANDLE is undefined in
         this case. This routine will attempt to unload the file from
         the DAS system.

     7)  If loading the input file would cause the maximum number of
         columns allowed in loaded EK files to be exceeded, the error
         SPICE(EKCOLDESCTABLEFULL) is signaled. HANDLE is undefined in
         this case. This routine will attempt to unload the file from
         the DAS system.

     8)  If loading the input file would cause the maximum allowed
         number of columns having distinct attributes in loaded EK
         files to be exceeded, the error SPICE(EKCOLATTRTABLEFULL) is
         signaled. HANDLE is undefined in this case. This routine will
         attempt to unload the file from the DAS system.

     9)  If loading the input file would cause the maximum number of
         instrument codes allowed in loaded EK files to be exceeded,
         the error SPICE(EKIDTABLEFULL) is signaled. HANDLE is
         undefined in this case. This routine will attempt to unload
         the file from the DAS system.

     10) If the input file does not contain at least one segment, the
         error SPICE(EKNOSEGMENTS) is signaled.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     See description of FNAME in $Detailed_Input.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This routine makes EK files known to the EK system. It is
     necessary to load EK files using this routine in order to
     query the files using the EK readers.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for these examples may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) Load two EK files and perform a query on them. During query
        execution, all files will be searched.

        Use the EK kernel below to load the Cassini Science Plan
        SPICE E-Kernel File based upon the integrated science
        plan #78.

           S78_CIMSSSUPa.bep

        Use the EK kernel below to load the data based upon the
        integrated science plan #79.

           S79_CIMSSSUPa.bep


        Example code begins here.


              PROGRAM EKLEF_EX1
              IMPLICIT NONE

        C
        C     Include the EK Maximum length of an input query,
        C     MAXQRY.
        C
              INCLUDE 'ekqlimit.inc'

        C
        C     Local parameters.
        C
              INTEGER               EKNMLN
              PARAMETER           ( EKNMLN = 17 )

              INTEGER               ERRLEN
              PARAMETER           ( ERRLEN = 1840 )

        C
        C     Local variables
        C
              CHARACTER*(EKNMLN)    EKNAMS ( 2 )
              CHARACTER*(ERRLEN)    ERRMSG
              CHARACTER*(MAXQRY)    QUERY

              INTEGER               HANDLE
              INTEGER               I
              INTEGER               N
              INTEGER               NMROWS

              LOGICAL               ERROR

        C
        C     Set up the array holding the EK file names.
        C
              DATA                  EKNAMS / 'S78_CIMSSSUPa.bep',
             .                               'S79_CIMSSSUPa.bep'  /

        C
        C     Load the EK files. This call could be replaced by a call
        C     to <a href="furnsh.html">FURNSH</a> (in this case, a meta-kernel listing the EKs
        C     to be loaded could also be used).
        C
              DO I = 1, 2

                 CALL <b>EKLEF</b> ( EKNAMS(I), HANDLE )
                 WRITE(*,'(2A)') 'Loading EK: ', EKNAMS(I)

              END DO

        C
        C     The EK files contain a table 'CASSINI_SP_OBSERVATION',
        C     that contains columns named:
        C
        C        NOTES, OBSERVATION_ID, OBSERVATION_TITLE,
        C        OBS_DESCRIPTION, SCIENCE_OBJECTIVE, SEQUENCE,
        C        SUBSYSTEM
        C
        C     Define a set of constraints to perform a query on all
        C     loaded EK files (the SELECT clause).
        C
              QUERY = 'Select SUBSYSTEM, SCIENCE_OBJECTIVE, '
             .   //   'OBSERVATION_ID from CASSINI_SP_OBSERVATION '
             .   //   'order by SUBSYSTEM'

        C
        C     Query the EK system for data rows matching the
        C     SELECT constraints.
        C
              CALL <a href="ekfind.html">EKFIND</a> ( QUERY, NMROWS, ERROR, ERRMSG )

        C
        C     Check whether an error occurred while processing the
        C     SELECT clause. If so, output the error message.
        C
              WRITE(*,*)
              IF ( ERROR ) THEN

                 WRITE(*,'(2A)') 'SELECT clause error: ', ERRMSG

              ELSE

        C
        C        If no error, NMROWS contains the number of rows
        C        matching the constraints specified in the query
        C        string.
        C
                 WRITE(*,'(A,I3)') 'Number of matching rows: ', NMROWS

              END IF


              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


        Loading EK: S78_CIMSSSUPa.bep
        Loading EK: S79_CIMSSSUPa.bep

        Number of matching rows:   9


     2) Repeat the previous exercise, using the same input kernels,
        but this time unloading the previous file before each new
        file is loaded. Unloading files prevents them from being
        searched during query execution.


        Example code begins here.


              PROGRAM EKLEF_EX2
              IMPLICIT NONE

        C
        C     Include the EK Maximum length of an input query,
        C     MAXQRY.
        C
              INCLUDE 'ekqlimit.inc'

        C
        C     Local parameters.
        C
              INTEGER               EKNMLN
              PARAMETER           ( EKNMLN = 17 )

              INTEGER               ERRLEN
              PARAMETER           ( ERRLEN = 1840 )

        C
        C     Local variables
        C
              CHARACTER*(EKNMLN)    EKNAMS ( 2 )
              CHARACTER*(ERRLEN)    ERRMSG
              CHARACTER*(MAXQRY)    QUERY

              INTEGER               HANDLE
              INTEGER               I
              INTEGER               N
              INTEGER               NMROWS

              LOGICAL               ERROR

        C
        C     Set up the array holding the EK file names.
        C
              DATA                  EKNAMS / 'S78_CIMSSSUPa.bep',
             .                               'S79_CIMSSSUPa.bep'  /

        C
        C     The EK files contain a table 'CASSINI_SP_OBSERVATION',
        C     that contains columns named:
        C
        C        NOTES, OBSERVATION_ID, OBSERVATION_TITLE,
        C        OBS_DESCRIPTION, SCIENCE_OBJECTIVE, SEQUENCE,
        C        SUBSYSTEM
        C
        C     Define a set of constraints to perform a query on all
        C     loaded EK files (the SELECT clause).
        C
              QUERY = 'Select SUBSYSTEM, SCIENCE_OBJECTIVE, '
             .   //   'OBSERVATION_ID from CASSINI_SP_OBSERVATION '
             .   //   'order by SUBSYSTEM'

        C
        C     Load the EK files. This call could be replaced by a call
        C     to <a href="furnsh.html">FURNSH</a>.
        C
              DO I = 1, 2

                 CALL <b>EKLEF</b> ( EKNAMS(I), HANDLE )
                 WRITE(*,'(2A)') 'Loading EK: ', EKNAMS(I)

        C
        C        Query the EK system for data rows matching the
        C        SELECT constraints.
        C
                 CALL <a href="ekfind.html">EKFIND</a> ( QUERY, NMROWS, ERROR, ERRMSG )

        C
        C        Check whether an error occurred while processing the
        C        SELECT clause. If so, output the error message.
        C
                 IF ( ERROR ) THEN

                    WRITE(*,'(2A)') 'SELECT clause error: ', ERRMSG

                 ELSE

        C
        C           If no error, NMROWS contains the number of rows
        C           matching the constraints specified in the query
        C           string.
        C
                    WRITE(*,'(A,I3)') 'Number of matching rows: ',
             .                        NMROWS

                 END IF

        C
        C        Unload the current file. Unloading files prevents
        C        them from being searched during query execution.
        C
                 CALL <a href="ekuef.html">EKUEF</a> ( HANDLE )
                 WRITE(*,'(2A)') 'Unloading EK: ', EKNAMS(I)
                 WRITE(*,*)

              END DO


              END


        When this program was executed on a Mac/Intel/gfortran/64-bit
        platform, the output was:


        Loading EK: S78_CIMSSSUPa.bep
        Number of matching rows:   4
        Unloading EK: S78_CIMSSSUPa.bep

        Loading EK: S79_CIMSSSUPa.bep
        Number of matching rows:   5
        Unloading EK: S79_CIMSSSUPa.bep
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     1)  EK files containing columns having the same name but
         inconsistent declarations are not diagnosed. Such kernels
         are invalid in any case.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     N.J. Bachman       (JPL)
     J. Diaz del Rio    (ODC Space)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 2.2.0, 06-JUL-2021 (JDR)

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Added complete
        code examples based on existing fragments.

    SPICELIB Version 2.1.0, 09-FEB-2015 (NJB)

        Now uses <a href="errhan.html">ERRHAN</a> to insert DAS file name into
        long error messages.

    SPICELIB Version 2.0.0, 16-NOV-2001 (NJB)

        Bug fix: When an already loaded kernel is opened with <a href="ekopr.html">EKOPR</a>,
        it now has its link count reset to 1 via a call to <a href="ekcls.html">EKCLS</a>.

    SPICELIB Version 1.0.1, 07-JUL-1996 (NJB)

        Previous version line was changed from &quot;Beta&quot; to &quot;SPICELIB.&quot;

    SPICELIB Version 1.0.0, 23-OCT-1995 (NJB)</PRE>
<h4>Link to routine EKLEF source file <a href='../../../src/spicelib/ekqmgr.f'>ekqmgr.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:36:18 2021</pre>

</body>
</html>

