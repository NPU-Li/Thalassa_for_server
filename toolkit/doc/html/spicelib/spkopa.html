
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>

<HEAD>
   <TITLE>spkopa</TITLE>
</HEAD>

<BODY style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255);">
<A name="TOP"></A>

<table style="text-align: left; margin-left: auto; margin-right: auto; width: 800px;"
 border="0" cellpadding="5" cellspacing="2">
  <tbody>
    <tr><td>
<div align="center">
Index of Functions: 
<A HREF="index.html#A">A</A>&nbsp;
<A HREF="index.html#B">B</A>&nbsp;
<A HREF="index.html#C">C</A>&nbsp;
<A HREF="index.html#D">D</A>&nbsp;
<A HREF="index.html#E">E</A>&nbsp;
<A HREF="index.html#F">F</A>&nbsp;
<A HREF="index.html#G">G</A>&nbsp;
<A HREF="index.html#H">H</A>&nbsp;
<A HREF="index.html#I">I</A>&nbsp;
<A HREF="index.html#J">J</A>&nbsp;
<A HREF="index.html#K">K</A>&nbsp;
<A HREF="index.html#L">L</A>&nbsp;
<A HREF="index.html#M">M</A>&nbsp;
<A HREF="index.html#N">N</A>&nbsp;
<A HREF="index.html#O">O</A>&nbsp;
<A HREF="index.html#P">P</A>&nbsp;
<A HREF="index.html#Q">Q</A>&nbsp;
<A HREF="index.html#R">R</A>&nbsp;
<A HREF="index.html#S">S</A>&nbsp;
<A HREF="index.html#T">T</A>&nbsp;
<A HREF="index.html#U">U</A>&nbsp;
<A HREF="index.html#V">V</A>&nbsp;
<A HREF="index.html#W">W</A>&nbsp;
<A HREF="index.html#X">X</A>&nbsp;
</div>
</td></tr>

    <tr>
      <td style="background-color: rgb(153, 153, 153); vertical-align: middle; text-align: center;">
      <div align="right"> 
      <small><small><a href="index.html">Index Page</a></small></small>
      </div>
      <b>spkopa</b></td>
    </tr>
    

    <tr>
      <td style="vertical-align: top;">

       <br>
       <div align="left"><b>Table of contents</b></div>
       <table style="text-align: left; width: 60%; margin-left: auto; margin-right: auto;"
       border="0" cellspacing="2" cellpadding="2">
        <tbody>
          <tr>
            <td style="width: 33%; text-align: center;">
              <a href="#Procedure">Procedure<br></a>
              <a href="#Abstract">Abstract<br></a>
              <a href="#Required_Reading">Required_Reading<br></a>
              <a href="#Keywords">Keywords<br></a>
              <a href="#Declarations">Declarations<br></a>
              <a href="#Brief_I/O">Brief_I/O<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <a href="#Detailed_Input">Detailed_Input<br></a>
              <a href="#Detailed_Output">Detailed_Output<br></a>
              <a href="#Parameters">Parameters<br></a>
              <a href="#Exceptions">Exceptions<br></a>
              <a href="#Files">Files<br></a>
              <a href="#Particulars">Particulars<br></a>

              </td>
              <td style="vertical-align: top; width: 33%; text-align: center;">              <big><b><a href="#Examples">Examples<br></a></b></big>
              <a href="#Restrictions">Restrictions<br></a>
              <a href="#Literature_References">Literature_References<br></a>
              <a href="#Author_and_Institution">Author_and_Institution<br></a>
              <a href="#Version">Version<br></a>
            </td>
          </tr>
        </tbody>
</table>
<hr>

<h4><a name="Procedure">Procedure</a></h4>
<PRE>
     SPKOPA ( SPK open for addition )

     SUBROUTINE SPKOPA ( FILE, HANDLE )
</PRE>
<h4><a name="Abstract">Abstract</a></h4>
<PRE>
     Open an existing SPK file for subsequent write.
</PRE>
<h4><a name="Required_Reading">Required_Reading</a></h4>
<PRE>
     <a href="../req/spk.html">SPK</a>
</PRE>
<h4><a name="Keywords">Keywords</a></h4>
<PRE>
     SPK
</PRE>
<h4><a name="Declarations">Declarations</a></h4>
<PRE>
     IMPLICIT NONE

     CHARACTER*(*)         FILE
     INTEGER               HANDLE
</PRE>
<h4><a name="Brief_I/O">Brief_I/O</a></h4>
<PRE>
     VARIABLE  I/O  DESCRIPTION
     --------  ---  --------------------------------------------------
     FILE       I   The name of an existing SPK file.
     HANDLE     O   Handle attached to the SPK file opened to append.
</PRE>
<h4><a name="Detailed_Input">Detailed_Input</a></h4>
<PRE>
     FILE     is the name of an existing SPK file to which
              you wish to append additional SPK segments.
</PRE>
<h4><a name="Detailed_Output">Detailed_Output</a></h4>
<PRE>
     HANDLE   is the DAF integer handle that refers to the SPK file
              opened for appending. HANDLE is required by any of the
              SPK writing routines.
</PRE>
<h4><a name="Parameters">Parameters</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Exceptions">Exceptions</a></h4>
<PRE>
     If any of the following exceptions occur, HANDLE will be returned
     with the value 0.

     1)  If the file specified does not exist, the error
         SPICE(FILENOTFOUND) is signaled.

     2)  If the file specified is not an SPK file, the error
         SPICE(FILEISNOTSPK) is signaled.

     3)  If the specified SPK file cannot be opened for writing, an
         error is signaled by a routine in the call tree of this
         routine.

     4)  If the specified SPK file uses a non-native binary file
         format, an error is signaled by a routine in the call tree of
         this routine.

     5)  If the specified SPK file is corrupted or otherwise invalid,
         an error is signaled by a routine in the call tree of this
         routine.
</PRE>
<h4><a name="Files">Files</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Particulars">Particulars</a></h4>
<PRE>
     This file provides an interface for opening existing SPK
     files for the addition of SPK segments. If you need
     to open an new SPK file for writing, call the routine <a href="spkopn.html">SPKOPN</a>.
</PRE>
<h4><a name="Examples">Examples</a></h4>
<PRE>
     The numerical results shown for this example may differ across
     platforms. The results depend on the SPICE kernels used as
     input, the compiler and supporting libraries, and the machine
     specific arithmetic implementation.

     1) This example demonstrates how to add a new segment to a
        new and to an existing SPK file.

        For this example, we will first create an SPK file containing
        only one type 5 segment, given a time-ordered set of
        discrete states and epochs, and the gravitational parameter
        of a central body.

        Then, we will reopen the SPK and add another type 5 segment.
        The example below shows one set of calls that you could
        perform to make the addition. Obviously, there is no need to
        close and re-open the file in order to add multiple segments.
        It is done in this example to demonstrate the use of <b>SPKOPA</b>.

        Note that you could add segments of other data types by
        replacing the call to <a href="spkw05.html">SPKW05</a> with a suitably modified call to
        another SPK writing routine.


        Example code begins here.


              PROGRAM SPKOPA_EX1
              IMPLICIT NONE

        C
        C     Local parameters.
        C
              INTEGER               NAMLEN
              PARAMETER           ( NAMLEN = 40 )

        C
        C     Define the segment identifier parameters.
        C
              CHARACTER*(*)         SPK5
              PARAMETER           ( SPK5  = 'spkopa_ex1.bsp' )

              CHARACTER*(*)         REF
              PARAMETER           ( REF    = 'J2000'          )

              DOUBLE PRECISION      GMSUN
              PARAMETER           ( GMSUN  = 132712440023.310D0 )

              INTEGER               BODY
              PARAMETER           ( BODY   = 3  )

              INTEGER               CENTER
              PARAMETER           ( CENTER = 10 )

              INTEGER               NSTATS
              PARAMETER           ( NSTATS = 9  )

        C
        C     Local variables.
        C
              CHARACTER*(NAMLEN)    IFNAME
              CHARACTER*(NAMLEN)    SEGID

              DOUBLE PRECISION      EPOCH1 (    NSTATS )
              DOUBLE PRECISION      EPOCH2 (    NSTATS )
              DOUBLE PRECISION      FIRST
              DOUBLE PRECISION      LAST
              DOUBLE PRECISION      STATES ( 6, NSTATS )

              INTEGER               HANDLE
              INTEGER               NCOMCH

        C
        C     Define the states and epochs.
        C
              DATA                  STATES /
             .       101.D0, 201.D0, 301.D0, 401.D0, 501.D0, 601.D0,
             .       102.D0, 202.D0, 302.D0, 402.D0, 502.D0, 602.D0,
             .       103.D0, 203.D0, 303.D0, 403.D0, 503.D0, 603.D0,
             .       104.D0, 204.D0, 304.D0, 404.D0, 504.D0, 604.D0,
             .       105.D0, 205.D0, 305.D0, 405.D0, 505.D0, 605.D0,
             .       106.D0, 206.D0, 306.D0, 406.D0, 506.D0, 606.D0,
             .       107.D0, 207.D0, 307.D0, 407.D0, 507.D0, 607.D0,
             .       108.D0, 208.D0, 308.D0, 408.D0, 508.D0, 608.D0,
             .       109.D0, 209.D0, 309.D0, 409.D0, 509.D0, 609.D0 /

              DATA                  EPOCH1 / 100.D0, 200.D0, 300.D0,
             .                               400.D0, 500.D0, 600.D0,
             .                               700.D0, 800.D0, 900.D0 /

              DATA                  EPOCH2 /
             .                            1100.D0, 1200.D0, 1300.D0,
             .                            1400.D0, 1500.D0, 1600.D0,
             .                            1700.D0, 1800.D0, 1900.D0 /

        C
        C     Set the start and stop times of interval covered by
        C     the first segment.
        C
              FIRST  = EPOCH1(1)
              LAST   = EPOCH1(NSTATS)

        C
        C     NCOMCH is the number of characters to reserve for the
        C     kernel's comment area. This example doesn't write
        C     comments, so set to zero.
        C
              NCOMCH = 0

        C
        C     Internal file name and segment ID.
        C
              IFNAME = 'Type 5 SPK internal file name.'
              SEGID  = 'SPK type 5 test segment #1'

        C
        C     Open a new SPK file.
        C
              CALL <a href="spkopn.html">SPKOPN</a>( SPK5, IFNAME, NCOMCH, HANDLE )

        C
        C     Write the segment.
        C
              CALL <a href="spkw05.html">SPKW05</a> ( HANDLE, BODY,   CENTER, REF,
             .              FIRST,  LAST,   SEGID,  GMSUN,
             .              NSTATS, STATES, EPOCH1        )

        C
        C     Close the SPK file.
        C
              CALL <a href="spkcls.html">SPKCLS</a> ( HANDLE )

        C
        C     At this point we have an existing SPK type 5 kernel
        C     that contains a single segment. Let's now demonstrate
        C     the use of <b>SPKOPA</b>.
        C
        C     Open the an existing SPK file for subsequent write.
        C
              CALL <b>SPKOPA</b> ( SPK5, HANDLE )

        C
        C     Set the start and stop times of interval covered by
        C     the second segment, and the segment ID.
        C
              FIRST  = EPOCH2(1)
              LAST   = EPOCH2(NSTATS)

              SEGID  = 'SPK type 5 test segment #2'

        C
        C     Now write the second segment. Use the same set of
        C     states time-ordered set of discrete states and the
        C     gravitational parameter. Set the epochs to be EPOCH2.
        C
              CALL <a href="spkw05.html">SPKW05</a> ( HANDLE, BODY,   CENTER, REF,
             .              FIRST,  LAST,   SEGID,  GMSUN,
             .              NSTATS, STATES, EPOCH2        )

        C
        C     Finally, close the file.
        C
              CALL <a href="spkcls.html">SPKCLS</a> ( HANDLE )


              END


        When this program is executed, no output is presented on
        screen. After run completion, a new SPK type 5, with two
        segments, exists in the output directory.
</PRE>
<h4><a name="Restrictions">Restrictions</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Literature_References">Literature_References</a></h4>
<PRE>
     None.
</PRE>
<h4><a name="Author_and_Institution">Author_and_Institution</a></h4>
<PRE>
     J. Diaz del Rio    (ODC Space)
     W.L. Taber         (JPL)
</PRE>
<h4><a name="Version">Version</a></h4>
<PRE>
    SPICELIB Version 1.1.0, 06-JUL-2021 (JDR)

        Added IMPLICIT NONE statement.

        Edited the header to comply with NAIF standard. Added complete
        code example.

        Updated the contents of $Detailed_Output and $Exceptions.

    SPICELIB Version 1.0.0, 10-MAR-1999 (WLT)</PRE>
<h4>Link to routine SPKOPA source file <a href='../../../src/spicelib/spkopa.f'>spkopa.f</a> </h4>

      </td>
    </tr>
  </tbody>
</table>

   <pre>Fri Dec 31 18:36:53 2021</pre>

</body>
</html>

